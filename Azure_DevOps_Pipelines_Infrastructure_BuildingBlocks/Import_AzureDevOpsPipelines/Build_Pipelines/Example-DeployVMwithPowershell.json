{"options":[{"enabled":false,"definition":{"id":"5d58cc01-7c75-450c-be18-a388ddb129ec"},"inputs":{"branchFilters":"[\"+refs/heads/*\"]","additionalFields":"{}"}},{"enabled":false,"definition":{"id":"a9db38f9-9fdc-478c-b0f9-464221e58316"},"inputs":{"workItemType":"1991277","assignToRequestor":"true","additionalFields":"{}"}}],"variables":{"localPass":{"value":"P@ssw0rd123456"},"localUser":{"value":"localUser"},"Location":{"value":"EastUS"},"Network":{"value":"BuildingBlocks"},"ResourceGroup":{"value":"BuildingBlocks"},"Subnet":{"value":"Subnet1"},"system.debug":{"value":"false","allowOverride":true},"VMName":{"value":"BuildingBlocks"},"VMSize":{"value":"Standard_B2s"}},"retentionRules":[{"branches":["+refs/heads/*"],"artifacts":[],"artifactTypesToDelete":["FilePath","SymbolStore"],"daysToKeep":10,"minimumToKeep":1,"deleteBuildRecord":true,"deleteTestResults":true}],"properties":{},"tags":[],"_links":{"self":{"href":"https://jriekse5555.visualstudio.com/d66d935a-f337-488d-a015-fe8e9522e055/_apis/build/Definitions/8?revision=32"},"web":{"href":"https://jriekse5555.visualstudio.com/d66d935a-f337-488d-a015-fe8e9522e055/_build/definition?definitionId=8"},"editor":{"href":"https://jriekse5555.visualstudio.com/d66d935a-f337-488d-a015-fe8e9522e055/_build/designer?id=8&_a=edit-build-definition"},"badge":{"href":"https://jriekse5555.visualstudio.com/d66d935a-f337-488d-a015-fe8e9522e055/_apis/build/status/8"}},"jobAuthorizationScope":1,"jobTimeoutInMinutes":60,"jobCancelTimeoutInMinutes":5,"process":{"phases":[{"steps":[{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Create Resource Group","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"72a1931b-effb-4d2e-8fd8-f8472a07cb62","versionSpec":"3.*","definitionType":"task"},"inputs":{"ConnectedServiceNameSelector":"ConnectedServiceNameARM","ConnectedServiceName":"","ConnectedServiceNameARM":"0d77f11a-d10a-4b2a-9903-ae68126c6b09","ScriptType":"InlineScript","ScriptPath":"","Inline":"#Note all variables with the syntax \"$()\" are DevOps variables that need to predefined\n\n# Create Resource Group\nNew-AzureRMResourceGroup -Name \"$(ResourceGroup)\" -Location \"$(Location)\"","ScriptArguments":"","errorActionPreference":"stop","FailOnStandardError":"false","TargetAzurePs":"LatestVersion","CustomTargetAzurePs":""}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Create Virtual Network and Subnet","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"72a1931b-effb-4d2e-8fd8-f8472a07cb62","versionSpec":"3.*","definitionType":"task"},"inputs":{"ConnectedServiceNameSelector":"ConnectedServiceNameARM","ConnectedServiceName":"","ConnectedServiceNameARM":"0d77f11a-d10a-4b2a-9903-ae68126c6b09","ScriptType":"InlineScript","ScriptPath":"","Inline":"#Note all variables with the syntax \"$()\" are DevOps variables that need to predefined\n\n# Create Virtual Network\n$virtualNetwork = New-AzureRMVirtualNetwork `\n  -ResourceGroupName \"$(ResourceGroup)\" `\n  -Location \"$(Location)\" `\n  -Name \"$(Network)\" `\n  -AddressPrefix 11.0.0.0/16\n\n#Create Subnet\nAdd-AzureRMVirtualNetworkSubnetConfig `\n  -Name \"Subnet1\" `\n  -AddressPrefix 11.0.0.0/24 `\n  -VirtualNetwork $virtualNetwork\n\n#Associate subnet with virtual network\n$virtualNetwork | Set-AzureRMVirtualNetwork","ScriptArguments":"","errorActionPreference":"stop","FailOnStandardError":"false","TargetAzurePs":"LatestVersion","CustomTargetAzurePs":""}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Create NIC ","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"72a1931b-effb-4d2e-8fd8-f8472a07cb62","versionSpec":"3.*","definitionType":"task"},"inputs":{"ConnectedServiceNameSelector":"ConnectedServiceNameARM","ConnectedServiceName":"","ConnectedServiceNameARM":"0d77f11a-d10a-4b2a-9903-ae68126c6b09","ScriptType":"InlineScript","ScriptPath":"","Inline":"#Note all variables with the syntax \"$()\" are DevOps variables that need to predefined\n\n# Creates variable for NIC name using DevOps variable for VMName with 'NIC' suffix\n$NICName = \"$(VMName)\" + \"NIC\"\n\n# Gets Subnet ID for NIC creation\n$vnet = Get-AzsureRMVirtualNetwork -Name \"$(Network)\" -ResourceGroupName \"$(ResourceGroup)\"\n$SubnetObject = $vnet.Subnets[0].Id \n\n# Creates NIC using previous variables and DevOps variables\n$NIC = New-AzureRmNetworkInterface -Name $NICName -ResourceGroupName \"$(ResourceGroup)\" -Location \"$(Location)\" -SubnetId $SubnetObject -Force","ScriptArguments":"","errorActionPreference":"stop","FailOnStandardError":"false","TargetAzurePs":"LatestVersion","CustomTargetAzurePs":""}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Add Public IP to NIC","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"72a1931b-effb-4d2e-8fd8-f8472a07cb62","versionSpec":"3.*","definitionType":"task"},"inputs":{"ConnectedServiceNameSelector":"ConnectedServiceNameARM","ConnectedServiceName":"","ConnectedServiceNameARM":"0d77f11a-d10a-4b2a-9903-ae68126c6b09","ScriptType":"InlineScript","ScriptPath":"","Inline":"#Adds a public IP to a NIC\n#Note all variables with the syntax \"$()\" are DevOps variables that need to predefined\n#Sets up Public IP object name\n$PublicIPName = \"Public-\" + \"$(VMName)\"\n#Creates Public IP object\n$PublicIP = New-AzureRmPublicIpAddress -Name $PublicIPName -ResourceGroupName \"$(ResourceGroup)\" -AllocationMethod Dynamic -Location \"$(Location)\" -Force\n\n#Sets NIC Name that was created previously\n$NICName = \"$(VMName)\" + \"NIC\"\n#Retrieves NIC object from name\n$NIC = Get-AzureRmNetworkInterface -ResourceGroupName \"$(ResourceGroup)\" -Name $NICName\n#Assign public IP object to NIC\n$nic.IpConfigurations[0].PublicIpAddress = $PublicIP\n#Updates NIC object\n$NIC | Set-AzureRmNetworkInterface","ScriptArguments":"","errorActionPreference":"stop","FailOnStandardError":"false","TargetAzurePs":"LatestVersion","CustomTargetAzurePs":""}},{"environment":{},"enabled":true,"continueOnError":false,"alwaysRun":false,"displayName":"Deploy VM","timeoutInMinutes":0,"condition":"succeeded()","task":{"id":"72a1931b-effb-4d2e-8fd8-f8472a07cb62","versionSpec":"3.*","definitionType":"task"},"inputs":{"ConnectedServiceNameSelector":"ConnectedServiceNameARM","ConnectedServiceName":"","ConnectedServiceNameARM":"0d77f11a-d10a-4b2a-9903-ae68126c6b09","ScriptType":"InlineScript","ScriptPath":"","Inline":"$localPass = ConvertTo-SecureString \"$(localPass)\" -AsPlainText -Force\n$NICName = \"$(VMName)\" + \"NIC\"\n$NIC = Get-AzureRmNetworkInterface -ResourceGroupName \"$(ResourceGroup)\" -Name $NICName\n\n$Credential = New-Object System.Management.Automation.PSCredential (\"$(localUser)\", $localPass)\n\n$VirtualMachine = New-AzureRmVMConfig -VMName \"$(VMName)\" -VMSize \"$(VMSize)\"\n$VirtualMachine = Set-AzureRmVMOperatingSystem -VM $VirtualMachine -Windows -ComputerName \"$(VMName)\" -Credential $Credential -ProvisionVMAgent -EnableAutoUpdate\n$VirtualMachine = Add-AzureRmVMNetworkInterface -VM $VirtualMachine -Id $NIC.Id\n$VirtualMachine = Set-AzureRmVMSourceImage -VM $VirtualMachine -PublisherName 'MicrosoftWindowsServer' -Offer 'WindowsServer' -Skus '2016-Datacenter' -Version 'latest'\n$VirtualMachine = Set-AzureRmVMOSDisk -VM $VirtualMachine -CreateOption 'FromImage' -StorageAccountType 'Standard_LRS'  -Name \"$(VMName)-osdisk\"\n$VirtualMachine = Add-AzureRmVMDataDisk -VM $VirtualMachine -Lun 0 -CreateOption 'Empty' -Name \"$(VMName)-datadisk1\" -StorageAccountType 'Standard_LRS' -Caching None -DiskSizeinGB 127\n$VirtualMachine = Set-AzureRmVMBootDiagnostics -VM $VirtualMachine -Disable\n\nNew-AzureRmVM -ResourceGroupName \"$(ResourceGroup)\" -Location \"$(Location)\" -VM $VirtualMachine -Verbose \n\n","ScriptArguments":"","errorActionPreference":"stop","FailOnStandardError":"false","TargetAzurePs":"LatestVersion","CustomTargetAzurePs":""}}],"name":"Agent job 1","refName":"Phase_1","condition":"succeeded()","target":{"executionOptions":{"type":0},"allowScriptsAuthAccessOption":false,"type":1},"jobAuthorizationScope":1,"jobCancelTimeoutInMinutes":1}],"type":1},"repository":{"properties":{"cleanOptions":"0","labelSources":"0","labelSourcesFormat":"$(build.buildNumber)","reportBuildStatus":"true","gitLfsSupport":"false","skipSyncSource":"false","checkoutNestedSubmodules":"false","fetchDepth":"0"},"id":"d90828ed-4a5c-4c06-8f84-f7453c940e38","type":"TfsGit","name":"MyFirstProject","url":"https://jriekse5555.visualstudio.com/MyFirstProject/_git/MyFirstProject","defaultBranch":"refs/heads/master","clean":"false","checkoutSubmodules":false},"processParameters":{},"quality":1,"authoredBy":{"displayName":"Jim Riekse","url":"https://spsprodcus2.vssps.visualstudio.com/Abdab41d2-5971-43f1-82b6-ddf33aa18cf2/_apis/Identities/1d1e1f67-48ac-6a99-9a98-0b415b2def73","_links":{"avatar":{"href":"https://jriekse5555.visualstudio.com/_apis/GraphProfile/MemberAvatars/aad.MWQxZTFmNjctNDhhYy03YTk5LTlhOTgtMGI0MTViMmRlZjcz"}},"id":"1d1e1f67-48ac-6a99-9a98-0b415b2def73","uniqueName":"jiriekse@microsoft.com","imageUrl":"https://jriekse5555.visualstudio.com/_api/_common/identityImage?id=1d1e1f67-48ac-6a99-9a98-0b415b2def73","descriptor":"aad.MWQxZTFmNjctNDhhYy03YTk5LTlhOTgtMGI0MTViMmRlZjcz"},"drafts":[],"queue":{"_links":{"self":{"href":"https://jriekse5555.visualstudio.com/_apis/build/Queues/37"}},"id":37,"name":"Hosted Windows 2019 with VS2019","url":"https://jriekse5555.visualstudio.com/_apis/build/Queues/37","pool":{"id":8,"name":"Hosted Windows 2019 with VS2019","isHosted":true}},"id":8,"name":"Example-DeployVMwithPowershell","url":"https://jriekse5555.visualstudio.com/d66d935a-f337-488d-a015-fe8e9522e055/_apis/build/Definitions/8?revision=32","uri":"vstfs:///Build/Definition/8","path":"\\","type":2,"queueStatus":0,"revision":32,"createdDate":"2019-02-24T19:00:25.200Z","project":{"id":"d66d935a-f337-488d-a015-fe8e9522e055","name":"MyFirstProject","url":"https://jriekse5555.visualstudio.com/_apis/projects/d66d935a-f337-488d-a015-fe8e9522e055","state":1,"revision":8,"visibility":0,"lastUpdateTime":"2018-07-31T20:17:09.000Z"}}